(function(e){function t(t){for(var i,a,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&p.push(n[a][0]),n[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],i=!0,r=1;r<s.length;r++){var l=s[r];0!==n[l]&&(i=!1)}i&&(o.splice(t--,1),e=a(a.s=s[0]))}return e}var i={},n={app:0},o=[];function a(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=i,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0a15":function(e,t,s){},"0f56":function(e,t,s){"use strict";var i=s("4e74"),n=s.n(i);n.a},1:function(e,t){},2629:function(e,t,s){"use strict";var i=s("d784"),n=s.n(i);n.a},"2e2a":function(e,t,s){"use strict";var i=s("4f1d"),n=s.n(i);n.a},3075:function(e,t,s){"use strict";var i=s("e9d0"),n=s.n(i);n.a},"371c":function(e,t,s){"use strict";var i=s("c33f"),n=s.n(i);n.a},"3f9a":function(e,t,s){"use strict";var i=s("749c"),n=s.n(i);n.a},"4e74":function(e,t,s){},"4f1d":function(e,t,s){},"4f7a":function(e,t,s){"use strict";var i=s("cd63"),n=s.n(i);n.a},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},o=[],a={name:"app",created:function(){var e=this;sessionStorage.getItem("store")&&this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(sessionStorage.getItem("store")))),window.addEventListener("beforeunload",(function(){sessionStorage.setItem("store",JSON.stringify(e.$store.state))}))}},r=a,l=s("2877"),c=Object(l["a"])(r,n,o,!1,null,null,null),d=c.exports,u=s("8c4f"),p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"loginForm",staticClass:"login-container",attrs:{rules:e.rules,model:e.loginForm,"label-position":"left","label-width":"0px"}},[s("h3",{staticClass:"login_title"},[e._v("系统登录")]),s("el-form-item",{attrs:{prop:"userTel"}},[s("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"手机号"},model:{value:e.loginForm.userTel,callback:function(t){e.$set(e.loginForm,"userTel",t)},expression:"loginForm.userTel"}})],1),s("el-form-item",{attrs:{prop:"userPwd"}},[s("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.userPwd,callback:function(t){e.$set(e.loginForm,"userPwd",t)},expression:"loginForm.userPwd"}})],1),s("el-checkbox",{staticClass:"login_remember",attrs:{"label-position":"left"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")]),s("el-form-item",{staticStyle:{width:"100%"}},[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitClick("loginForm")}}},[e._v("登录")])],1)],1)},m=[],h=(s("ac1f"),s("5319"),s("bc3a")),f=s.n(h),v="http://39.102.80.119:8080";f.a.defaults.withCredentials=!0;var g=function(e,t){return f()({method:"post",url:"".concat(v).concat(e),data:t,headers:{"Content-Type":"application/json"}})},b=function(e,t){return f()({method:"put",url:"".concat(v).concat(e),data:t,headers:{"Content-Type":"application/json"}})},k=function(e){return f()({method:"delete",url:"".concat(v).concat(e)})},w=function(e,t){return f()({method:"get",params:t,transformRequest:[function(e){var t="";for(var s in e)t+=encodeURIComponent(s)+"="+encodeURIComponent(e[s])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"".concat(v).concat(e)})},y=function(){var e=new Date,t=e.getFullYear(),s=e.getMonth()+1,i=e.getDate();s=s>9?s:"0"+s,i=i>9?i:"0"+i;var n=t+"-"+s+"-"+i+" ";return n},U={data:function(){return{rules:{userTel:[{required:!0,message:"请输入手机号",trigger:"blur"}],userPwd:[{required:!0,message:"请输入密码",trigger:"blur"}]},checked:!0,loginForm:{userTel:"15516392395",userPwd:"123123"},loading:!1}},methods:{submitClick:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var s=t;t.loading=!0,g("/web/login",t.loginForm).then((function(e){s.loading=!1,e.data?(s.$store.commit("login",e.data),s.$router.replace({path:"/home"})):s.$alert("手机号或密码错误!","失败!")}),(function(e){s.loading=!1,s.$alert("找不到服务器⊙﹏⊙∥!","失败!")}))}))}}},_=U,T=(s("0f56"),Object(l["a"])(_,p,m,!1,null,"201508c6",null)),C=T.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",{staticClass:"home_container"},[s("el-header",[s("div",{staticClass:"home_title"},[e._v("应急指挥演练辅助平台 ")]),s("div",{staticClass:"userInfo"},[s("el-dropdown",{on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(this.$store.state.userName)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出登录")])],1)],1)],1)]),s("el-container",[s("el-aside",{attrs:{width:"200px"}},[s("el-menu",{staticClass:"el-menu-vertical-demo",staticStyle:{"background-color":"#ececec"},attrs:{"default-active":"0",router:""}},[e._l(this.$router.options.routes,(function(t,i){return[t.hidden?e._e():[t.children.length>1?s("el-submenu",{key:i,attrs:{index:i+""}},[s("template",{slot:"title"},[s("i",{class:t.iconCls}),s("span",[e._v(e._s(t.name))])]),e._l(t.children,(function(t){return s("el-menu-item",{key:t.path,attrs:{index:t.path}},[e._v(e._s(t.name))])}))],2):[s("el-menu-item",{key:t.children[0].path,attrs:{index:t.children[0].path}},[s("i",{class:t.children[0].iconCls}),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.children[0].name))])])]]]}))],2)],1),s("el-main",[s("router-view")],1)],1),s("el-footer",[e._v("©防灾科技学院 应急管理学院")])],1)},$=[],x={mounted:function(){},methods:{handleCommand:function(e){this[e]()},logout:function(){this.$store.commit("logout"),this.$router.replace("/")}}},F=x,L=(s("2629"),Object(l["a"])(F,V,$,!1,null,null,null)),P=L.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:5}},[s("el-input",{attrs:{placeholder:"请输入标题或用户姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getLiveVideos(t)}},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success"},on:{click:e.getLiveVideos}},[e._v("搜索")])],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success",title:e.patten?"切换地图模式":"切换列表模式",icon:"el-icon-s-operation"},on:{click:function(t){e.patten=!e.patten}}})],1),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"请选择布局"},model:{value:e.videoSpan,callback:function(t){e.videoSpan=t},expression:"videoSpan"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e.patten?s("div",[s("el-row",{directives:[{name:"show",rawName:"v-show",value:0!=e.liveVideoList.length,expression:"liveVideoList.length != 0"}]},[s("el-col",{attrs:{span:18}},[s("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),s("div",{staticStyle:{margin:"15px 0"}}),s("el-row",{attrs:{gutter:20}},[s("el-checkbox-group",{on:{change:e.handleChange},model:{value:e.checkedUserTels,callback:function(t){e.checkedUserTels=t},expression:"checkedUserTels"}},[s("draggable",{staticClass:"list-group",attrs:{animation:200},on:{start:e.testStart,end:e.testEnd},model:{value:e.liveVideoList,callback:function(t){e.liveVideoList=t},expression:"liveVideoList"}},e._l(e.liveVideoList,(function(t,i){return s("el-col",{key:t.videoId,attrs:{span:e.videoSpan}},[s("div",{staticClass:"dislike",on:{click:function(s){return e.dislikeVideo(t,i)}}},[e._v("x")]),s("VideoPlayer",{ref:"video"+t.videoId,refInFor:!0,attrs:{options:{controls:!0,autoplay:!0,muted:!0,fluid:!0,liveui:!0,sources:[{src:t.url,type:"rtmp/flv"}]}}}),s("VideoInfo",{attrs:{videoInfo:t}}),s("el-checkbox",{attrs:{label:t.userTel}},[s("div",{staticStyle:{display:"none"}})])],1)})),1)],1)],1)],1),s("el-col",{attrs:{span:5}},[s("ChatRoom",{ref:"chat",attrs:{checkedUserTels:e.checkedUserTels_},on:{liveVideo:e.newLive}})],1)],1)],1):s("div",[s("VideoMap",{attrs:{videoPoints:e.liveVideoList}})],1)],1)},I=[],M=(s("4160"),s("d81d"),s("a434"),s("159b"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"videoPlayer"},[s("video",{ref:"videoPlayer",staticClass:"video-js vjs-big-play-centered"})])}),O=[],S=s("f0e2"),j=(s("fda2"),s("b5c1"),{name:"VideoPlayer",props:{options:{type:Object,default:function(){return{}}}},data:function(){return{player:null}},mounted:function(){this.init()},beforeDestroy:function(){this.player&&this.player.dispose()},methods:{dis:function(){this.player.dispose()},open:function(){this.player.paly()},init:function(){this.player=Object(S["a"])(this.$refs.videoPlayer,this.options),this.player.width("600"),console.log(this.player.aspectRatio("4:3"))},setCurrentTime:function(e,t){var s=this.getSeconds(e,t);this.player.currentTime(s)},getSeconds:function(e,t){var s=t.getHours()-e.getHours(),i=t.getMinutes()-e.getMinutes(),n=t.getSeconds()-e.getSeconds();return 3600*s+60*i+n}}}),E=j,A=(s("3f9a"),Object(l["a"])(E,M,O,!1,null,"70917afe",null)),N=A.exports,R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("baidu-map",{staticClass:"bm-view",attrs:{center:e.baiduMap.center,"scroll-wheel-zoom":e.baiduMap.scrollWheelZoom,zoom:e.baiduMap.zoom,ak:"MaNFkHxfgMEfEodDwDsB6pbE95pj3dCB"},on:{ready:e.handler}},[e._l(e.videoLists,(function(t){return[s("bm-marker",{key:t.videoId,attrs:{position:{lng:t.lng,lat:t.lat},clicking:!0,animation:"BMAP_ANIMATION_BOUNCE"},on:{click:function(s){return e.clickPoint(t)}}})]})),s("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}})],2),e.videoDialog?[s("el-dialog",{attrs:{title:"视频资源",visible:e.videoDialog,width:"50%"},on:{"update:visible":function(t){e.videoDialog=t}}},[s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:12}},[s("VideoPlayer",{attrs:{options:e.options}})],1),s("el-col",{attrs:{span:12}},[s("MapInfo",{attrs:{mapInfo:e.selectVideo}})],1)],1)],1)]:e._e()],2)},B=[],z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",[s("el-col",{attrs:{span:12}},[s("div",[s("i",{staticClass:"el-icon-user-solid"}),e._v("姓名:")])]),s("el-col",{attrs:{span:12}},[s("div",{domProps:{textContent:e._s(e.videoInfo.user.userName)}})]),s("el-col",{attrs:{span:12}},[s("div",[s("i",{staticClass:"el-icon-phone"}),e._v("手机号:")])]),s("el-col",{attrs:{span:12}},[s("div",{domProps:{textContent:e._s(e.videoInfo.userTel)}})]),s("el-col",{attrs:{span:12}},[s("div",[s("i",{staticClass:"el-icon-add-location"}),e._v("经度:")])]),s("el-col",{attrs:{span:12}},[s("div",{domProps:{textContent:e._s(e.videoInfo.lat)}})]),s("el-col",{attrs:{span:12}},[s("div",[s("i",{staticClass:"el-icon-add-location"}),e._v("纬度:")])]),s("el-col",{attrs:{span:12}},[s("div",{domProps:{textContent:e._s(e.videoInfo.lng)}})])],1)},H=[],J={data:function(){return{videoInfo:this.mapInfo}},props:{mapInfo:{type:Object,default:function(){return{}}}}},W=J,q=(s("4f7a"),Object(l["a"])(W,z,H,!1,null,"5cc9e66a",null)),Y=q.exports,Z={data:function(){return{baiduMap:{center:{lng:"116.1",lat:"39.820"},zoom:10,scrollWheelZoom:!0},videoLists:this.videoPoints,selectVideo:"",videoDialog:!1,options:{controls:!0,autoplay:!0,muted:!0,fluid:!0,sources:[{src:"",type:"rtmp/flv"}]}}},props:{videoPoints:{type:Array,default:function(){return[]}}},watch:{videoLists:function(e){this.$message.success("当前有"+e.length+"个视频资源"),console.log(e[0].lat),this.baiduMap.center.lat=e.length>0?e[0].lat:"39.820",this.baiduMap.center.lng=e.length>0?e[0].lng:"116.1"}},methods:{clickPoint:function(e){this.videoDialog=!0,this.selectVideo=e,console.log(e),1==e.flag?this.options.sources[0].src=e.url:this.options.sources[0].src=e.videoUrl},handler:function(){this.baiduMap.center.lat=this.videoLists.length>0?this.videoLists[0].lat:"39.820",this.baiduMap.center.lng=this.videoLists.length>0?this.videoLists[0].lng:"116.1"}},mounted:function(){this.$message.success("当前有"+this.videoLists.length+"个视频资源")},components:{VideoPlayer:N,MapInfo:Y}},G=Z,K=(s("2e2a"),Object(l["a"])(G,R,B,!1,null,null,null)),Q=K.exports,X=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticClass:"videoTitle"},[e._v(e._s(e.video.title))]),s("el-row",{staticClass:"videoFoot"},[s("el-col",{attrs:{span:12}},[s("i",{staticClass:"el-icon-user"}),e._v(e._s(e.video.user.userName))]),s("el-col",{staticClass:"date",attrs:{span:12}},[s("i",{staticClass:"el-icon-date"}),e._v(e._s(e._f("timeFormat")(e.video.startTime)))])],1)],1)},ee=[],te={data:function(){return{video:this.videoInfo}},props:{videoInfo:{type:Object}},filters:{timeFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}}},se=te,ie=(s("3075"),Object(l["a"])(se,X,ee,!1,null,"466b2a9a",null)),ne=ie.exports,oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chatRoom"},[s("div",{staticClass:"top",attrs:{id:"top"}},[s("h3",[e._v("聊天")]),s("hr"),s("ul",e._l(e.chatList,(function(t,i){return s("li",{key:i,staticClass:"list-item"},[s("div",{staticClass:"userMessage"},[s("span",[e._v(e._s(t.userTel)+":")]),s("span",[e._v(e._s(t.message))])])])})),0)]),s("div",{staticClass:"bottom"},[s("el-input",{attrs:{placeholder:"请输入信息"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.websocketsend(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),s("el-button",{nativeOn:{click:function(t){return e.websocketsend(t)}}},[e._v("发送")])],1)])},ae=[],re=(s("a15b"),{data:function(){return{message:"",websock:null,chatList:[],websocketUrl:"ws://192.168.1.29:8080/webSocketServer/"+this.$store.state.userTel,receivedUserTels:this.checkedUserTels}},props:{checkedUserTels:{type:Array}},methods:{initWebSocket:function(){this.websock=new WebSocket(this.websocketUrl),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose},websocketonopen:function(){console.log("连接成功")},websocketonerror:function(){console.log("连接失败重新连接"),this.initWebSocket()},websocketonmessage:function(e){console.log("接受数据");var t=JSON.parse(e.data);null!=t.message?this.chatList.push(t):this.$emit("liveVideo",t)},websocketsend:function(){switch(this.websock.readyState){case 0:return this.$message("正在连接中，请稍后重试"),!1;case 2:return this.$message("连接正在关闭"),!1;case 3:return this.$message("没有连接到服务器"),!1}if(0==this.receivedUserTels.length)this.$message("请选择要发送的用户");else if(""==this.message)this.$message("请填写要发送的信息");else{var e={sendUserTel:this.$store.state.userTel,message:this.message,sendTime:new Date,userTels:this.receivedUserTels.join(",")};this.websock.send(JSON.stringify(e))}},websocketclose:function(){console.log("断开连接")}},updated:function(){var e=document.getElementById("top");e.scrollTop=e.scrollHeight},created:function(){this.initWebSocket()},destroyed:function(){this.websock.close()}}),le=re,ce=(s("ebdf"),Object(l["a"])(le,oe,ae,!1,null,"e3cc21a2",null)),de=ce.exports,ue=s("310e"),pe=s.n(ue),me={data:function(){return{liveVideoList:[],dislikeVideoList:[],title:"",patten:!0,checkedUserTels:[],checkedUserTels_:[],checkAll:!1,isIndeterminate:!0,options:[{value:12,label:"每行显示2个"},{value:8,label:"每行显示3个"},{value:6,label:"每行显示4个"},{value:4,label:"每行显示6个"},{value:3,label:"每行显示8个"},{value:2,label:"每行显示12个"}],videoSpan:6}},components:{VideoPlayer:N,VideoMap:Q,VideoInfo:ne,ChatRoom:de,draggable:pe.a},methods:{getLiveVideos:function(){var e=this,t={title:this.title};g("/web/liveVideos",t).then((function(t){e.liveVideoList=t.data}),(function(e){console.log(e.data)}))},dislikeVideo:function(e,t){this.liveVideoList.splice(t,1),this.dislikeVideoList.push(e)},newLive:function(e){this.liveVideoList.push(e)},handleCheckAllChange:function(e){var t=this;this.checkedUserTels=e?this.liveVideoList.map((function(e){return e.userTel})):[],this.isIndeterminate=!1,this.checkedUserTels_.splice(0,this.checkedUserTels_.length),this.checkedUserTels.forEach((function(e){return t.checkedUserTels_.push(e)}))},handleChange:function(e){var t=this,s=e.length;this.checkAll=s===this.liveVideoList.length,this.isIndeterminate=s>0&&s<this.liveVideoList.length,this.checkedUserTels_.splice(0,this.checkedUserTels_.length),this.checkedUserTels.forEach((function(e){return t.checkedUserTels_.push(e)}))},testStart:function(e){console.log(e),console.log("开始了"),this.$refs["video113"][0].dis()},testEnd:function(){console.log("结束了")}},mounted:function(){this.getLiveVideos()}},he=me,fe=(s("7c6c"),Object(l["a"])(he,D,I,!1,null,null,null)),ve=fe.exports,ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:6}},[s("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},model:{value:e.videoFilterFactors.timeRange,callback:function(t){e.$set(e.videoFilterFactors,"timeRange",t)},expression:"videoFilterFactors.timeRange"}})],1),s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.videoFilterFactors.title,callback:function(t){e.$set(e.videoFilterFactors,"title",t)},expression:"videoFilterFactors.title"}})],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success"},on:{click:e.initVideos}},[e._v("搜索")])],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success",title:e.patten?"切换地图模式":"切换列表模式",icon:"el-icon-s-operation"},on:{click:function(t){e.patten=!e.patten}}})],1)],1),e.patten?s("div",[s("el-row",{attrs:{gutter:40}},e._l(e.recordVideoList,(function(e){return s("el-col",{key:e.videoId,attrs:{span:6}},[s("VideoPlayer",{attrs:{options:{controls:!0,autoplay:!0,muted:!0,sources:[{src:e.videoUrl,type:"rtmp/flv"}]}}}),s("VideoInfo",{attrs:{videoInfo:e}})],1)})),1)],1):s("div",[s("VideoMap",{attrs:{videoPoints:e.recordVideoList}})],1)],1)},be=[],ke={data:function(){return{patten:!0,recordVideoList:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-6048e5),e.$emit("pick",[s,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-2592e6),e.$emit("pick",[s,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-7776e6),e.$emit("pick",[s,t])}}]},videoFilterFactors:{timeRange:"",title:""}}},components:{VideoPlayer:N,VideoMap:Q,VideoInfo:ne},methods:{initVideos:function(){var e=this,t={title:this.videoFilterFactors.title,startTime:this.videoFilterFactors.timeRange[0],endTime:this.videoFilterFactors.timeRange[1]};console.log(t),g("/web/videos",t).then((function(t){e.recordVideoList=t.data}))}},mounted:function(){this.initVideos()}},we=ke,ye=(s("371c"),Object(l["a"])(we,ge,be,!1,null,null,null)),Ue=ye.exports,_e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:8}},[s("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success"},on:{click:e.initVideos}},[e._v("搜索")])],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success",disabled:0==e.checkedVideos.length},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加标题")])],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success",disabled:0==e.checkedVideos.length},on:{click:e.synVideos}},[e._v("同步播放")])],1),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{type:"success",title:e.patten?"切换地图模式":"切换列表模式",icon:"el-icon-s-operation"},on:{click:function(t){e.patten=!e.patten}}})],1)],1),e.patten?s("div",[s("el-row",{directives:[{name:"show",rawName:"v-show",value:0!=e.recordVideoList.length,expression:"recordVideoList.length != 0"}],attrs:{gutter:20}},[s("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),s("el-checkbox-group",{model:{value:e.checkedVideos,callback:function(t){e.checkedVideos=t},expression:"checkedVideos"}},[s("draggable",{staticClass:"list-group",attrs:{list:e.recordVideoList,animation:200}},e._l(e.recordVideoList,(function(t){return s("el-col",{key:t.videoId,attrs:{span:6}},[s("VideoPlayer",{ref:"video"+t.videoId,refInFor:!0,attrs:{options:{controls:!0,autoplay:!0,muted:!0,fluid:!0,sources:[{src:t.videoUrl,type:"rtmp/flv"}]}}}),s("VideoInfo",{attrs:{videoInfo:t}}),s("el-checkbox",{attrs:{label:t}},[s("div",{staticStyle:{display:"none"}},[e._v("1")])])],1)})),1)],1)],1)],1):s("div",[s("VideoMap",{attrs:{videoPoints:e.recordVideoList}})],1),s("el-dialog",{attrs:{title:"添加标题",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addTitle}},[e._v("确 定")])],1)],1)],1)},Te=[],Ce=(s("13d5"),{data:function(){return{patten:!0,title:"",dialogVisible:!1,isIndeterminate:!0,checkAll:!1,checkedVideos:[],recordVideoList:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-6048e5),e.$emit("pick",[s,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-2592e6),e.$emit("pick",[s,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,s=new Date;s.setTime(s.getTime()-7776e6),e.$emit("pick",[s,t])}}]},timeRange:""}},components:{VideoPlayer:N,VideoMap:Q,VideoInfo:ne,draggable:pe.a},methods:{handleCheckAllChange:function(e){this.checkedVideos=e?this.recordVideoList:[],this.isIndeterminate=!1},addTitle:function(){var e=this,t=this,s=this.checkedVideos.map((function(e){return e.videoId})).join(),i={ids:s,title:this.title};w("/web/addTitle",i).then((function(s){200==s.data.statusCode?e.$message({message:s.data.msg,type:"success"}):e.$message({message:s.data.msg,type:"error"}),t.title="",t.initVideos()})),this.dialogVisible=!1},initVideos:function(){var e=this;if(!this.timeRange){var t=y()+"00:00:00",s=y()+"23:59:59";this.timeRange=[t,s]}var i={startTime:this.timeRange[0],endTime:this.timeRange[1]};g("/web/latestVideos",i).then((function(t){e.recordVideoList=t.data}),(function(e){console.log(e.data)}))},synVideos:function(){var e=this,t=this.getLatestTime(this.checkedVideos);this.checkedVideos.forEach((function(s){e.$refs["video".concat(s.videoId)][0].setCurrentTime(new Date(s.startTime),t)}))},getLatestTime:function(e){var t=e.map((function(e){return new Date(e.startTime)})),s=t.reduce((function(e,t){return e>t?e:t}));return s}},mounted:function(){this.initVideos()}}),Ve=Ce,$e=(s("857f"),Object(l["a"])(Ve,_e,Te,!1,null,null,null)),xe=$e.exports,Fe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",[s("el-col",{attrs:{span:3}},[s("el-button",{attrs:{type:"success"},on:{click:e.handleAddUser}},[e._v("添加用户")])],1),s("el-col",{attrs:{span:3}},[s("el-button",{attrs:{type:"danger",disabled:0==e.deleteUsers.length},on:{click:e.handleDeleteUsers}},[e._v("批量删除")])],1)],1),s("el-table",{attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),s("el-table-column",{attrs:{prop:"userName",label:"姓名",width:"180"}}),s("el-table-column",{attrs:{prop:"userTel",label:"手机号",width:"180"}}),s("el-table-column",{attrs:{prop:"isAdmin",label:"用户身份",formatter:e.isAdmin}}),s("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",name:t,placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),s("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":e.page.pageSizes,"page-size":e.page.limit,total:e.page.total,"current-page":e.page.currentPage},on:{"current-change":e.currentChange,"size-change":e.limitChange}}),s("el-dialog",{attrs:{title:"新增用户",visible:e.addUserDiaLog,width:"30%"},on:{"update:visible":function(t){e.addUserDiaLog=t}}},[s("el-form",{ref:"addUserForm",attrs:{model:e.addUserForm,"status-icon":"",rules:e.addUserDiaLogRules}},[s("el-form-item",{attrs:{label:"用户权限"}},[s("el-select",{attrs:{placeholder:"请选择用户身份"},model:{value:e.addUserForm.isAdmin,callback:function(t){e.$set(e.addUserForm,"isAdmin",t)},expression:"addUserForm.isAdmin"}},[s("el-option",{attrs:{label:"普通用户",value:"0"}}),s("el-option",{attrs:{label:"管理员用户",value:"1"}})],1)],1),s("el-form-item",{attrs:{label:"姓名",prop:"userName"}},[s("el-input",{attrs:{disabled:""==e.addUserForm.isAdmin},model:{value:e.addUserForm.userName,callback:function(t){e.$set(e.addUserForm,"userName",t)},expression:"addUserForm.userName"}})],1),s("el-form-item",{attrs:{label:"手机号",prop:"userTel"}},[s("el-input",{attrs:{disabled:""==e.addUserForm.isAdmin},model:{value:e.addUserForm.userTel,callback:function(t){e.$set(e.addUserForm,"userTel",t)},expression:"addUserForm.userTel"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"userPwd"}},[s("el-input",{attrs:{type:"password",disabled:""==e.addUserForm.isAdmin},model:{value:e.addUserForm.userPwd,callback:function(t){e.$set(e.addUserForm,"userPwd",t)},expression:"addUserForm.userPwd"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"checkUserPwd"}},[s("el-input",{attrs:{type:"password",disabled:""==e.addUserForm.isAdmin},model:{value:e.addUserForm.checkUserPwd,callback:function(t){e.$set(e.addUserForm,"checkUserPwd",t)},expression:"addUserForm.checkUserPwd"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.addUserDiaLog=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser("addUserForm")}}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"编辑用户",visible:e.editUserDiaLog,width:"50%"},on:{"update:visible":function(t){e.editUserDiaLog=t}}},[s("el-form",{ref:"editUserForm",attrs:{inline:!0,model:e.editUserForm,rules:e.editUserDiaLogRules}},[s("el-form-item",{attrs:{label:"姓名",prop:"userName"}},[s("el-input",{attrs:{placeholder:"姓名"},model:{value:e.editUserForm.userName,callback:function(t){e.$set(e.editUserForm,"userName",t)},expression:"editUserForm.userName"}})],1),s("el-form-item",{attrs:{label:"手机号",prop:"userTel"}},[s("el-input",{attrs:{placeholder:"手机号"},model:{value:e.editUserForm.userTel,callback:function(t){e.$set(e.editUserForm,"userTel",t)},expression:"editUserForm.userTel"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.editUserDiaLog=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUser("editUserForm")}}},[e._v("确 定")])],1)],1)],1)},Le=[],Pe={data:function(){var e=this,t=function(e,t,s){var i=/^[\u4E00-\u9FA5]{2,4}$/;i.test(t)?s():s(new Error("姓名格式不正确"))},s=function(e,t,s){var i=/^1[3-578]\d{9}$/;i.test(t)?s():s(new Error("请输入正确格式的手机号"))},i=function(t,s,i){""===s?i(new Error("请输入密码")):(""!==e.addUserForm.userPwd&&e.$refs.addUserForm.validateField("checkUserPwd"),i())},n=function(t,s,i){""===s?i(new Error("请再次输入密码")):s!==e.addUserForm.userPwd?i(new Error("两次输入密码不一致!")):i()};return{page:{paginationFlag:!1,pageSizes:[6,10,20],total:0,limit:6,currentPage:1},search:"",deleteUsers:[],editUserDiaLog:!1,addUserDiaLog:!1,editUserForm:[],oldUserTel:"",userTelShow:!1,addUserForm:{userName:"",userTel:"",isAdmin:"",userPwd:"",checkUserPwd:""},addUserDiaLogRules:{userName:[{validator:t,trigger:"blur"}],userTel:[{validator:s,trigger:"blur"}],userPwd:[{validator:i,trigger:"blur"}],checkUserPwd:[{validator:n,trigger:"blur"}]},editUserDiaLogRules:{userName:[{validator:t,trigger:"change"}],userTel:[{validator:s,trigger:"change"}]},tableData:[]}},methods:{handleSelectionChange:function(e){this.deleteUsers=e},handleEdit:function(e,t){this.editUserDiaLog=!0,this.editUserForm=t,this.oldUserTel=t.userTel},handleAddUser:function(){this.addUserDiaLog=!0},addUser:function(e){var t=this,s=this;this.$refs[e].validate((function(e){if(!e)return!1;s.addUserDiaLog=!1,g("/web/users",s.addUserForm).then((function(e){200==e.data.statusCode?(s.$message({message:e.data.msg,type:"success"}),s.addUserForm={userName:"",userTel:"",isAdmin:"",userPwd:"",checkUserPwd:""},window.eventBus.$emit("userManage")):400==e.data.statusCode&&s.$message.error(e.data.msg)}),(function(){t.$message.error("网络出错")}))}))},editUser:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.editUserDiaLog=!1,b("/web/users?oldUserTel="+t.oldUserTel,t.editUserForm).then((function(e){200==e.data.statusCode?(t.$message({message:e.data.msg,type:"success"}),window.eventBus.$emit("userManage")):400==e.data.statusCode&&(t.$message.error(e.data.msg),window.eventBus.$emit("userManage"))}),(function(){t.$message.error("网络出错")}))}))},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){k("/web/users/"+t.userTel).then((function(e){200==e.data.statusCode?(s.$message.success(e.data.msg),window.eventBus.$emit("userManage")):s.$message.error(e.data.msg)}),(function(){s.$message.error("网络出错")}))})).catch((function(){s.$message({type:"info",message:"已取消删除"})}))},isAdmin:function(e,t,s,i){return"1"==s?"管理员":"0"==s?"普通用户":"无"},handleDeleteUsers:function(){var e=this;this.$confirm("此操作将永久删除所选用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.deleteUsers.map((function(e){return e.userTel})).join();w("/web/deleteUserList",{userTels:t}).then((function(){e.$message({type:"success",message:"删除成功!"}),window.eventBus.$emit("userManage")}),(function(){e.$message.error("网络出错")}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},loadingUsers:function(e,t){var s=this,i="/web/users?limit="+e+"&offset="+t;w(i).then((function(e){s.tableData=e.data.users,s.page.total=e.data.total}))},limitChange:function(e){this.page.limit=e;var t=(this.page.currentPage-1)*e;this.loadingUsers(e,t)},currentChange:function(e){this.page.currentPage=e;var t=(e-1)*this.page.limit;this.loadingUsers(this.page.limit,t)}},mounted:function(){var e=this;this.loadingUsers(this.page.limit,0),window.eventBus.$on("userManage",(function(){var t=(e.page.currentPage-1)*e.page.limit;console.log(e.page.limit),console.log(t),e.loadingUsers(e.page.limit,t)}))}},De=Pe,Ie=(s("9917"),Object(l["a"])(De,Fe,Le,!1,null,null,null)),Me=Ie.exports;i["default"].use(u["a"]);var Oe=[{path:"/",name:"登录",hidden:!0,component:C},{path:"/home",name:"",hidden:!0,component:P},{path:"/home",component:P,iconCls:"fa fa-file-text-o",children:[{path:"/live",name:"直播管理",component:ve}]},{path:"/home",name:"录播管理",component:P,iconCls:"fa fa-file-text-o",children:[{path:"/latestrecord",name:"最新录播",component:xe},{path:"/record",name:"历史录播",component:Ue}]},{path:"/home",component:P,children:[{path:"/user",name:"用户管理",iconCls:"fa fa-user-o",component:Me}]}],Se=new u["a"]({mode:"history",base:"/",routes:Oe}),je=Se,Ee=s("2f62");i["default"].use(Ee["a"]);var Ae=new Ee["a"].Store({state:{userTel:"",userName:""},mutations:{login:function(e,t){e.userTel=t.userTel,e.userName=t.userName},logout:function(e){e.userTel="",e.userName=""}},actions:{},modules:{}}),Ne=s("5c96"),Re=s.n(Ne);s("0fae");i["default"].use(Re.a);var Be=s("bd0c"),ze=s.n(Be);i["default"].use(ze.a,{ak:"MaNFkHxfgMEfEodDwDsB6pbE95pj3dCB"}),window.eventBus=new i["default"],i["default"].config.productionTip=!1,new i["default"]({router:je,store:Ae,render:function(e){return e(d)}}).$mount("#app")},"749c":function(e,t,s){},"7c6c":function(e,t,s){"use strict";var i=s("ec07"),n=s.n(i);n.a},"857f":function(e,t,s){"use strict";var i=s("aec9"),n=s.n(i);n.a},9917:function(e,t,s){"use strict";var i=s("a8b4"),n=s.n(i);n.a},a8b4:function(e,t,s){},aec9:function(e,t,s){},c33f:function(e,t,s){},cd63:function(e,t,s){},d784:function(e,t,s){},e9d0:function(e,t,s){},ebdf:function(e,t,s){"use strict";var i=s("0a15"),n=s.n(i);n.a},ec07:function(e,t,s){}});
//# sourceMappingURL=app.8e4e78c0.js.map