(function(e){function t(t){for(var n,o,l=t[0],r=t[1],c=t[2],d=0,p=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,l=1;l<a.length;l++){var r=a[l];0!==s[r]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},s={app:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=r;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";a("85ec")},"0f1c":function(e,t,a){},1:function(e,t){},2629:function(e,t,a){"use strict";a("d7846")},2765:function(e,t,a){"use strict";a("c8a0")},"2c52":function(e,t,a){"use strict";a("0f1c")},"2e2a":function(e,t,a){"use strict";a("4f1d")},"371c":function(e,t,a){"use strict";a("c33f")},"3eab":function(e,t,a){"use strict";a("eb6b")},"4f1d":function(e,t,a){},"54ef":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},i=[],o={name:"app",created:function(){var e=this;sessionStorage.getItem("store")&&this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(sessionStorage.getItem("store")))),window.addEventListener("beforeunload",(function(){sessionStorage.setItem("store",JSON.stringify(e.$store.state))}))}},l=o,r=(a("034f"),a("2877")),c=Object(r["a"])(l,s,i,!1,null,null,null),u=c.exports,d=a("5c96"),p=a.n(d),m=(a("0fae"),a("8c4f")),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"loginForm",staticClass:"login-container",attrs:{rules:e.rules,model:e.loginForm,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"login_title"},[e._v("系统登录")]),a("el-form-item",{attrs:{prop:"userTel"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"手机号"},model:{value:e.loginForm.userTel,callback:function(t){e.$set(e.loginForm,"userTel",t)},expression:"loginForm.userTel"}})],1),a("el-form-item",{attrs:{prop:"userPwd"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.userPwd,callback:function(t){e.$set(e.loginForm,"userPwd",t)},expression:"loginForm.userPwd"}})],1),a("el-checkbox",{staticClass:"login_remember",attrs:{"label-position":"left"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")]),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitClick("loginForm")}}},[e._v("登录")])],1)],1)},f=[],g=(a("ac1f"),a("5319"),a("d3b7"),a("bc3a")),v=a.n(g),b={401:"认证失败",403:"无权限访问",404:"访问资源不存在",500:"服务器错误",default:"系统未知错误,请反馈给管理员"},y=void 0,k=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_API;v.a.defaults.withCredentials=!0;var w=v.a.create({baseURL:k,timeout:1e4});w.interceptors.response.use((function(e){console.log(e);var t=e.data.code||200,a=e.data.msg||b[t]||b["default"];return 200!=t?(Object(d["Message"])({type:"error",message:a}),Promise.reject(new Error(a))):e.data}),(function(e){return console.log("err"+e),y.$message({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var _=function(e,t){return w({method:"post",url:"".concat(e),data:t,headers:{"Content-Type":"application/json"}})},T=function(e,t){return w({method:"put",url:"".concat(e),data:t,headers:{"Content-Type":"application/json"}})},x=function(e){return w({method:"delete",url:"".concat(e)})},F=function(e,t){return w({method:"get",params:t,transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"".concat(e)})},P=function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();a=a>9?a:"0"+a,n=n>9?n:"0"+n;var s=t+"-"+a+"-"+n+" ";return s},$={data:function(){return{rules:{userTel:[{required:!0,message:"请输入手机号",trigger:"blur"}],userPwd:[{required:!0,message:"请输入密码",trigger:"blur"}]},checked:!0,loginForm:{userTel:"15516392395",userPwd:"123456"},loading:!1}},methods:{submitClick:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,_("/web/login",t.loginForm).then((function(e){console.log(e),t.loading=!1,t.$store.commit("login",e.data),t.$router.replace({path:"/home"})}),(function(e){t.loading=!1}))}))}}},I=$,S=(a("d910"),Object(r["a"])(I,h,f,!1,null,"cde7844e",null)),L=S.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"home_container"},[a("el-header",[a("div",{staticClass:"home_title"},[e._v("应急演练辅助教学平台 ")]),a("div",{staticClass:"userInfo"},[a("el-dropdown",{on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(this.$store.state.userName)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出登录")])],1)],1)],1)]),a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-menu",{staticClass:"el-menu-vertical-demo",staticStyle:{"background-color":"#ececec"},attrs:{"default-active":"0",router:""}},[e._l(this.$router.options.routes,(function(t,n){return[t.hidden?e._e():[t.children.length>1?a("el-submenu",{key:n,attrs:{index:n+""}},[a("template",{slot:"title"},[a("i",{class:t.iconCls}),a("span",[e._v(e._s(t.name))])]),e._l(t.children,(function(t){return a("el-menu-item",{key:t.path,attrs:{index:t.path}},[e._v(e._s(t.name))])}))],2):[a("el-menu-item",{key:t.children[0].path,attrs:{index:t.children[0].path}},[a("i",{class:t.children[0].iconCls}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.children[0].name))])])]]]}))],2)],1),a("el-main",[a("router-view")],1)],1),a("el-footer",[e._v("©防灾科技学院 应急管理学院")])],1)},V=[],N={methods:{handleCommand:function(e){this[e]()},logout:function(){this.$store.commit("logout"),this.$router.replace("/")}}},U=N,O=(a("2629"),Object(r["a"])(U,C,V,!1,null,null,null)),q=O.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:5}},[a("el-input",{attrs:{placeholder:"请输入标题或用户姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getLiveVideos(t)}},model:{value:e.queryParams.title,callback:function(t){e.$set(e.queryParams,"title",t)},expression:"queryParams.title"}})],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:e.getLiveVideos}},[e._v("搜索")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success",title:e.patten?"切换地图模式":"切换列表模式",icon:"el-icon-s-operation"},on:{click:function(t){e.patten=!e.patten}}})],1),a("el-col",{attrs:{span:4}},[a("el-select",{attrs:{placeholder:"请选择布局"},model:{value:e.videoSpan,callback:function(t){e.videoSpan=t},expression:"videoSpan"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e.patten?a("div",[a("el-row",{directives:[{name:"show",rawName:"v-show",value:0!=e.liveVideoList.length,expression:"liveVideoList.length != 0"}]},[a("el-col",{attrs:{span:18}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),a("div",{staticStyle:{margin:"15px 0"}}),a("el-row",{attrs:{gutter:20}},[a("el-checkbox-group",{on:{change:e.handleChange},model:{value:e.checkedUserTels,callback:function(t){e.checkedUserTels=t},expression:"checkedUserTels"}},[a("draggable",{staticClass:"list-group",attrs:{animation:200},on:{start:e.testStart,end:e.testEnd},model:{value:e.liveVideoList,callback:function(t){e.liveVideoList=t},expression:"liveVideoList"}},e._l(e.liveVideoList,(function(t,n){return a("el-col",{key:t.videoId,attrs:{span:e.videoSpan}},[a("div",{staticClass:"dislike",on:{click:function(a){return e.dislikeVideo(t,n)}}},[e._v("x")]),a("VideoPlayer",{ref:"video"+t.videoId,refInFor:!0,attrs:{options:{controls:!0,autoplay:!0,fluid:!0,liveui:!0,sources:[{src:t.url,type:"rtmp/flv"}]}}}),a("VideoInfo",{attrs:{videoInfo:t}}),a("el-checkbox",{attrs:{label:t.userTel}},[a("div",{staticStyle:{display:"none"}})])],1)})),1)],1)],1)],1),a("el-col",{attrs:{span:5}},[a("ChatRoom",{ref:"chat",attrs:{checkedUserTels:e.checkedUserTels_},on:{liveVideo:e.newLive}})],1)],1)],1):a("div",[a("VideoMap",{attrs:{videoPoints:e.liveVideoList}})],1)],1)},j=[],A=(a("4160"),a("d81d"),a("a434"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"videoPlayer"},[a("video",{ref:"videoPlayer",staticClass:"video-js vjs-time-control vjs-remaining-time vjs-big-play-centered"})])}),E=[],M=a("f0e2"),D=(a("fda2"),a("b5c1"),{name:"VideoPlayer",props:{options:{type:Object,default:function(){return{}}}},data:function(){return{player:null}},mounted:function(){this.init()},beforeDestroy:function(){this.player&&this.player.dispose()},methods:{dis:function(){this.player.dispose()},open:function(){this.player.paly()},init:function(){M["a"].options.aspectRatio="4:3",this.player=Object(M["a"])(this.$refs.videoPlayer,this.options,(function(){}))},setCurrentTime:function(e,t){var a=this.getSeconds(e,t);this.player.currentTime(a)},getSeconds:function(e,t){var a=t.getHours()-e.getHours(),n=t.getMinutes()-e.getMinutes(),s=t.getSeconds()-e.getSeconds();return 3600*a+60*n+s}}}),R=D,B=(a("3eab"),Object(r["a"])(R,A,E,!1,null,"f01ed71e",null)),H=B.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("baidu-map",{staticClass:"bm-view",attrs:{center:e.baiduMap.center,"scroll-wheel-zoom":e.baiduMap.scrollWheelZoom,zoom:e.baiduMap.zoom,ak:"MaNFkHxfgMEfEodDwDsB6pbE95pj3dCB"},on:{ready:e.handler}},[e._l(e.videoLists,(function(t){return[a("bm-marker",{key:t.videoId,attrs:{position:{lng:t.lng,lat:t.lat},clicking:!0,animation:"BMAP_ANIMATION_BOUNCE"},on:{click:function(a){return e.clickPoint(t)}}})]})),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}})],2),e.videoDialog?[a("el-dialog",{attrs:{title:"视频资源",visible:e.videoDialog,width:"50%"},on:{"update:visible":function(t){e.videoDialog=t}}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("VideoPlayer",{attrs:{options:e.options}})],1),a("el-col",{attrs:{span:12}},[a("MapInfo",{attrs:{mapInfo:e.selectVideo}})],1)],1)],1)]:e._e()],2)},W=[],Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{attrs:{span:12}},[a("div",[a("i",{staticClass:"el-icon-user-solid"}),e._v("姓名:")])]),a("el-col",{attrs:{span:12}},[a("div",{domProps:{textContent:e._s(e.videoInfo.user.userName)}})]),a("el-col",{attrs:{span:12}},[a("div",[a("i",{staticClass:"el-icon-phone"}),e._v("手机号:")])]),a("el-col",{attrs:{span:12}},[a("div",{domProps:{textContent:e._s(e.videoInfo.userTel)}})]),a("el-col",{attrs:{span:12}},[a("div",[a("i",{staticClass:"el-icon-add-location"}),e._v("经度:")])]),a("el-col",{attrs:{span:12}},[a("div",{domProps:{textContent:e._s(e.videoInfo.lat)}})]),a("el-col",{attrs:{span:12}},[a("div",[a("i",{staticClass:"el-icon-add-location"}),e._v("纬度:")])]),a("el-col",{attrs:{span:12}},[a("div",{domProps:{textContent:e._s(e.videoInfo.lng)}})])],1)},Z=[],G={data:function(){return{videoInfo:this.mapInfo}},props:{mapInfo:{type:Object,default:function(){return{}}}}},K=G,Q=(a("d4ac"),Object(r["a"])(K,Y,Z,!1,null,"85d36860",null)),X=Q.exports,ee={data:function(){return{baiduMap:{center:{lng:"116.1",lat:"39.820"},zoom:10,scrollWheelZoom:!0},videoLists:this.videoPoints,selectVideo:"",videoDialog:!1,options:{controls:!0,autoplay:!0,muted:!0,fluid:!0,sources:[{src:"",type:"rtmp/flv"}]}}},props:{videoPoints:{type:Array,default:function(){return[]}}},watch:{videoLists:function(e){this.$message.success("当前有"+e.length+"个视频资源"),console.log(e[0].lat),this.baiduMap.center.lat=e.length>0?e[0].lat:"39.820",this.baiduMap.center.lng=e.length>0?e[0].lng:"116.1"}},methods:{clickPoint:function(e){this.videoDialog=!0,this.selectVideo=e,console.log(e),1==e.flag?this.options.sources[0].src=e.url:this.options.sources[0].src=e.videoUrl},handler:function(){this.baiduMap.center.lat=this.videoLists.length>0?this.videoLists[0].lat:"39.820",this.baiduMap.center.lng=this.videoLists.length>0?this.videoLists[0].lng:"116.1"}},mounted:function(){this.$message.success("当前有"+this.videoLists.length+"个视频资源")},components:{VideoPlayer:H,MapInfo:X}},te=ee,ae=(a("2e2a"),Object(r["a"])(te,J,W,!1,null,null,null)),ne=ae.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"videoTitle"},[e._v(e._s(e.video.title))]),a("el-row",{staticClass:"videoFoot"},[a("el-col",{attrs:{span:12}},[a("i",{staticClass:"el-icon-user"}),e._v(e._s(e.video.user.userName))]),a("el-col",{staticClass:"date",attrs:{span:12}},[a("i",{staticClass:"el-icon-date"}),e._v(e._s(e._f("timeFormat")(e.video.startTime)))])],1)],1)},ie=[],oe={data:function(){return{video:this.videoInfo}},props:{videoInfo:{type:Object}},filters:{timeFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}}},le=oe,re=(a("eadb"),Object(r["a"])(le,se,ie,!1,null,"43daeccd",null)),ce=re.exports,ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chatRoom"},[a("div",{staticClass:"top",attrs:{id:"top"}},[a("h3",[e._v("聊天")]),a("hr"),a("ul",e._l(e.chatList,(function(t,n){return a("li",{key:n,staticClass:"list-item"},[a("div",{staticClass:"userMessage"},[a("span",[e._v(e._s(t.sendUserTel)+":")]),e._l(t.userTels.split(","),(function(t,n){return a("span",{key:n,staticClass:"userTel"},[e._v("@"+e._s(t))])})),a("span",[e._v(e._s(t.message))])],2)])})),0)]),a("div",{staticClass:"bottom"},[a("el-input",{attrs:{placeholder:"请输入信息"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.websocketsend(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),a("el-button",{nativeOn:{click:function(t){return e.websocketsend(t)}}},[e._v("发送")])],1)])},de=[],pe=(a("a15b"),{data:function(){return{message:"",websock:null,chatList:[],websocketUrl:"ws://47.98.45.93:8080/webSocketServer/"+this.$store.state.userTel,receivedUserTels:this.checkedUserTels}},props:{checkedUserTels:{type:Array}},methods:{initWebSocket:function(){this.websock=new WebSocket(this.websocketUrl),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose},websocketonopen:function(){console.log("连接成功")},websocketonerror:function(){console.log("连接失败重新连接"),this.initWebSocket()},websocketonmessage:function(e){console.log("接受数据");var t=JSON.parse(e.data);null!=t.message?this.chatList.push(t):this.$emit("liveVideo",t)},websocketsend:function(){switch(this.websock.readyState){case 0:return this.$message("正在连接中，请稍后重试"),!1;case 2:return this.$message("连接正在关闭"),!1;case 3:return this.$message("没有连接到服务器"),!1}if(0==this.receivedUserTels.length)this.$message("请选择要发送的用户");else if(""==this.message)this.$message("请填写要发送的信息");else{var e={sendUserTel:this.$store.state.userTel,message:this.message,sendTime:new Date,userTels:this.receivedUserTels.join(",")};this.websock.send(JSON.stringify(e)),this.chatList.push(e),this.message=""}},websocketclose:function(){console.log("断开连接")}},updated:function(){var e=document.getElementById("top");e.scrollTop=e.scrollHeight},created:function(){sessionStorage.getItem("message")&&(this.chatList=JSON.parse(sessionStorage.getItem("message"))),this.initWebSocket()},destroyed:function(){sessionStorage.setItem("message",JSON.stringify(this.chatList)),this.websock.close()}}),me=pe,he=(a("2c52"),Object(r["a"])(me,ue,de,!1,null,"318e4dd5",null)),fe=he.exports,ge=a("b76a"),ve=a.n(ge),be={data:function(){return{liveVideoList:[],dislikeVideoList:[],patten:!0,checkedUserTels:[],checkedUserTels_:[],checkAll:!1,isIndeterminate:!0,options:[{value:12,label:"每行显示2个"},{value:8,label:"每行显示3个"},{value:6,label:"每行显示4个"},{value:4,label:"每行显示6个"},{value:3,label:"每行显示8个"},{value:2,label:"每行显示12个"}],videoSpan:6,queryParams:{title:""}}},components:{VideoPlayer:H,VideoMap:ne,VideoInfo:ce,ChatRoom:fe,draggable:ve.a},methods:{getLiveVideos:function(){var e=this,t={title:this.title};_("/web/liveVideos",t).then((function(t){e.liveVideoList=t}),(function(e){console.log(e)}))},dislikeVideo:function(e,t){this.liveVideoList.splice(t,1),this.dislikeVideoList.push(e)},newLive:function(e){this.liveVideoList.push(e)},handleCheckAllChange:function(e){var t=this;this.checkedUserTels=e?this.liveVideoList.map((function(e){return e.userTel})):[],this.isIndeterminate=!1,this.checkedUserTels_.splice(0,this.checkedUserTels_.length),this.checkedUserTels.forEach((function(e){return t.checkedUserTels_.push(e)}))},handleChange:function(e){var t=this,a=e.length;this.checkAll=a===this.liveVideoList.length,this.isIndeterminate=a>0&&a<this.liveVideoList.length,this.checkedUserTels_.splice(0,this.checkedUserTels_.length),this.checkedUserTels.forEach((function(e){return t.checkedUserTels_.push(e)}))},testStart:function(e){console.log(e),console.log("开始了"),this.$refs["video113"][0].dis()},testEnd:function(){console.log("结束了")}},mounted:function(){this.getLiveVideos()}},ye=be,ke=(a("7c6c"),Object(r["a"])(ye,z,j,!1,null,null,null)),we=ke.exports,_e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},model:{value:e.videoFilterFactors.timeRange,callback:function(t){e.$set(e.videoFilterFactors,"timeRange",t)},expression:"videoFilterFactors.timeRange"}})],1),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.videoFilterFactors.title,callback:function(t){e.$set(e.videoFilterFactors,"title",t)},expression:"videoFilterFactors.title"}})],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:e.initVideos}},[e._v("搜索")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success",title:e.patten?"切换地图模式":"切换列表模式",icon:"el-icon-s-operation"},on:{click:function(t){e.patten=!e.patten}}})],1)],1),e.patten?a("div",[a("el-row",{attrs:{gutter:40}},e._l(e.recordVideoList,(function(e){return a("el-col",{key:e.videoId,ref:"videoWidth",refInFor:!0,attrs:{span:6}},[a("VideoPlayer",{attrs:{options:{controls:!0,autoplay:!0,muted:!0,height:"300",width:"400",sources:[{src:e.videoUrl,type:"rtmp/flv"}]}}}),a("VideoInfo",{attrs:{videoInfo:e}})],1)})),1)],1):a("div",[a("VideoMap",{attrs:{videoPoints:e.recordVideoList}})],1)],1)},Te=[],xe={data:function(){return{patten:!0,recordVideoList:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},videoFilterFactors:{timeRange:"",title:""}}},components:{VideoPlayer:H,VideoMap:ne,VideoInfo:ce},methods:{initVideos:function(){var e=this,t={title:this.videoFilterFactors.title,startTime:this.videoFilterFactors.timeRange[0],endTime:this.videoFilterFactors.timeRange[1]};console.log(t),_("/web/videos",t).then((function(t){e.recordVideoList=t}))}},mounted:function(){this.initVideos()}},Fe=xe,Pe=(a("371c"),Object(r["a"])(Fe,_e,Te,!1,null,null,null)),$e=Pe.exports,Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:e.initVideos}},[e._v("搜索")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success",disabled:0==e.checkedVideos.length},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加标题")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success",disabled:0==e.checkedVideos.length},on:{click:e.synVideos}},[e._v("同步播放")])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success",title:e.patten?"切换地图模式":"切换列表模式",icon:"el-icon-s-operation"},on:{click:function(t){e.patten=!e.patten}}})],1)],1),e.patten?a("div",[a("el-row",{directives:[{name:"show",rawName:"v-show",value:0!=e.recordVideoList.length,expression:"recordVideoList.length != 0"}],attrs:{gutter:20}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),a("el-checkbox-group",{model:{value:e.checkedVideos,callback:function(t){e.checkedVideos=t},expression:"checkedVideos"}},[a("draggable",{staticClass:"list-group",attrs:{list:e.recordVideoList,animation:200}},e._l(e.recordVideoList,(function(t){return a("el-col",{key:t.videoId,attrs:{span:6}},[a("VideoPlayer",{ref:"video"+t.videoId,refInFor:!0,attrs:{options:{controls:!0,autoplay:!0,muted:!0,fluid:!0,sources:[{src:t.videoUrl,type:"rtmp/flv"}]}}}),a("VideoInfo",{attrs:{videoInfo:t}}),a("el-checkbox",{attrs:{label:t}},[a("div",{staticStyle:{display:"none"}},[e._v("1")])])],1)})),1)],1)],1)],1):a("div",[a("VideoMap",{attrs:{videoPoints:e.recordVideoList}})],1),a("el-dialog",{attrs:{title:"添加标题",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addTitle}},[e._v("确 定")])],1)],1)],1)},Se=[],Le=(a("13d5"),{data:function(){return{patten:!0,title:"",dialogVisible:!1,isIndeterminate:!0,checkAll:!1,checkedVideos:[],recordVideoList:[],timeRange:""}},components:{VideoPlayer:H,VideoMap:ne,VideoInfo:ce,draggable:ve.a},mounted:function(){this.initVideos()},methods:{handleCheckAllChange:function(e){this.checkedVideos=e?this.recordVideoList:[],this.isIndeterminate=!1},addTitle:function(){var e=this,t=this,a=this.checkedVideos.map((function(e){return e.videoId})).join(),n={ids:a,title:this.title};F("/web/addTitle",n).then((function(a){200==a.data.statusCode?e.$message({message:a.data.msg,type:"success"}):e.$message({message:a.data.msg,type:"error"}),t.title="",t.initVideos()})),this.dialogVisible=!1},initVideos:function(){var e=this;if(!this.timeRange){var t=P()+"00:00:00",a=P()+"23:59:59";this.timeRange=[t,a]}var n={startTime:this.timeRange[0],endTime:this.timeRange[1]};_("/web/latestVideos",n).then((function(t){console.log(t),e.recordVideoList=t}),(function(e){console.log(e)}))},synVideos:function(){var e=this,t=this.getLatestTime(this.checkedVideos);this.checkedVideos.forEach((function(a){e.$refs["video".concat(a.videoId)][0].setCurrentTime(new Date(a.startTime),t)}))},getLatestTime:function(e){var t=e.map((function(e){return new Date(e.startTime)})),a=t.reduce((function(e,t){return e>t?e:t}));return a}}}),Ce=Le,Ve=(a("857f"),Object(r["a"])(Ce,Ie,Se,!1,null,null,null)),Ne=Ve.exports,Ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"success"},on:{click:e.addUser}},[e._v("添加用户")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"danger",disabled:0==e.deleteUsers.length},on:{click:e.handleDeleteUsers}},[e._v("批量删除")])],1)],1),a("el-table",{attrs:{data:e.userList,stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"userName",label:"姓名",width:"180"}}),a("el-table-column",{attrs:{prop:"userTel",label:"手机号",width:"180"}}),a("el-table-column",{attrs:{prop:"isAdmin",label:"用户身份",formatter:e.isAdmin}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getUsers}}),a("el-dialog",{attrs:{title:e.title,visible:e.flag,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.flag=t}}},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,"status-icon":""}},[a("el-form-item",{attrs:{label:"用户权限","label-width":"80px"}},[a("el-select",{attrs:{placeholder:"请选择用户身份",disabled:"编辑用户"==e.title},model:{value:e.userForm.isAdmin,callback:function(t){e.$set(e.userForm,"isAdmin",e._n(t))},expression:"userForm.isAdmin"}},e._l(e.isAdminList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"姓名","label-width":"80px",prop:"userName"}},[a("el-input",{model:{value:e.userForm.userName,callback:function(t){e.$set(e.userForm,"userName",t)},expression:"userForm.userName"}})],1),a("el-form-item",{attrs:{label:"手机号","label-width":"80px",prop:"userTel"}},[a("el-input",{attrs:{disabled:"编辑用户"==e.title},model:{value:e.userForm.userTel,callback:function(t){e.$set(e.userForm,"userTel",t)},expression:"userForm.userTel"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.flag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},Oe=[],qe={data:function(){return{queryParams:{pageNum:1,pageSize:10},userForm:{},deleteUsers:[],flag:!1,oldUserTel:"",userTelShow:!1,userList:[],loading:!1,total:0,title:"",isAdminList:[{label:"普通用户",value:0},{label:"管理员",value:1}]}},mounted:function(){this.getUsers()},methods:{addUser:function(){this.clearForm(),this.flag=!0,this.title="添加用户"},submit:function(){var e=this;"添加用户"==this.title?_("/user/users",this.userForm).then((function(t){e.flag=!1,e.getUsers(),console.log(t),e.$message({message:t.msg,type:"success"})})):"编辑用户"==this.title&&T("/user/users",this.userForm).then((function(t){e.flag=!1,e.getUsers(),e.$message({type:"success",message:t.msg})}))},getUsers:function(){var e=this;this.loading=!0,F("/user/users",this.queryParams).then((function(t){e.userList=t.rows,e.total=t.total,e.loading=!1}))},handleSelectionChange:function(e){this.deleteUsers=e},handleEdit:function(e,t){var a=this;this.clearForm(),this.flag=!0,this.title="编辑用户",F("/user/users/"+t.userTel).then((function(e){a.userForm=e.data}))},editUser:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.editUserDiaLog=!1,T("/user/users?oldUserTel="+t.oldUserTel,t.editUserForm).then((function(e){200==e.data.statusCode?(t.$message({message:e.data.msg,type:"success"}),window.eventBus.$emit("userManage")):400==e.data.statusCode&&(t.$message.error(e.data.msg),window.eventBus.$emit("userManage"))}),(function(){t.$message.error("网络出错")}))}))},handleDelete:function(e,t){var a=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){x("/user/users/"+t.userTel).then((function(e){a.getUsers(),a.$message({type:"success",message:e.msg})}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},isAdmin:function(e,t,a,n){return"1"==a?"管理员":"0"==a?"普通用户":"无"},handleDeleteUsers:function(){var e=this;this.$confirm("此操作将永久删除所选用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.deleteUsers.map((function(e){return e.userTel})).join();F("/user/deleteUserList",{userTels:t}).then((function(t){e.getUsers(),e.$message({type:"success",message:t.msg})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},clearForm:function(){this.userForm={userName:"",userTel:"",isAdmin:""}}}},ze=qe,je=(a("9917"),Object(r["a"])(ze,Ue,Oe,!1,null,null,null)),Ae=je.exports,Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.addPlan}},[e._v("新增演练")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[a("el-table-column",{attrs:{align:"center",prop:"planName",label:"演练名称"}}),a("el-table-column",{attrs:{align:"center",prop:"startTime",label:"开始时间",width:"180"}}),a("el-table-column",{attrs:{align:"center",prop:"endTime",label:"结束时间"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getPlans}}),a("el-dialog",{attrs:{title:e.title,visible:e.flag,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.flag=t}}},[a("el-form",{attrs:{model:e.planForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"演练名称"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.planForm.planName,callback:function(t){e.$set(e.planForm,"planName",t)},expression:"planForm.planName"}})],1),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.planForm.startTime,callback:function(t){e.$set(e.planForm,"startTime",t)},expression:"planForm.startTime"}})],1),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.planForm.endTime,callback:function(t){e.$set(e.planForm,"endTime",t)},expression:"planForm.endTime"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.flag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},Me=[],De={data:function(){return{queryParams:{pageNum:1,pageSize:10},data:[],flag:!1,planForm:{},loading:!1,title:"",total:0}},mounted:function(){this.getPlans()},methods:{getPlans:function(){var e=this;this.loading=!0,F("/plan/plans",this.queryParams).then((function(t){console.log(t),e.data=t.rows,e.total=t.total,e.loading=!1}))},addPlan:function(){this.clearForm(),this.flag=!0,this.title="新增应急演练"},submit:function(){var e=this;this.planForm.planId?T("/plan/plans",this.planForm).then((function(t){e.flag=!1,e.getPlans(),e.$message({message:t.msg,type:"success"})})):_("/plan/plans",this.planForm).then((function(t){e.flag=!1,e.getPlans(),e.$message({message:t.msg,type:"success"})}))},clearForm:function(){this.planForm={planName:"",startTime:"",endTime:""}},handleUpdate:function(e){var t=this;this.clearForm(),F("/plan/plans/"+e.planId).then((function(e){t.planForm=e.data,t.flag=!0,t.title="修改应急演练"}))},handleDelete:function(e){var t=this;this.$confirm('是否确认删除应急演练编号为"'+e.planId+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return console.log("hello"),x("/plan/plans/"+e.planId)})).then((function(){t.getPlans(),t.$message({message:"删除成功",type:"success"})}))}}},Re=De,Be=Object(r["a"])(Re,Ee,Me,!1,null,null,null),He=Be.exports,Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[e._v(" 选择演练: ")]),a("el-col",{attrs:{span:1.5}},[a("el-select",{attrs:{size:"small"},on:{change:e.getAttachments},model:{value:e.queryParams.planId,callback:function(t){e.$set(e.queryParams,"planId",t)},expression:"queryParams.planId"}},e._l(e.planList,(function(e){return a("el-option",{key:e.planId,attrs:{label:e.planName,value:e.planId}})})),1)],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",disabled:!e.queryParams.planId},on:{click:e.handleAdd}},[e._v("新增附件")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[a("el-table-column",{attrs:{align:"center",prop:"fileName",label:"附件名"}}),a("el-table-column",{attrs:{align:"center",prop:"path",label:"附件路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"success",target:"_blank",href:t.row.path}},[e._v(e._s(t.row.path))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getAttachments}}),a("el-dialog",{attrs:{title:e.title,visible:e.flag,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.flag=t}}},[a("el-form",{attrs:{model:e.attachmentForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"附件名称"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"on-success":e.uploadSuccess,"on-change":e.handleChange,"file-list":e.fileList}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"success"},slot:"trigger"},[e._v("点击上传")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.flag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},We=[],Ye={data:function(){return{queryParams:{pageNum:1,pageSize:10,planId:""},planList:"",title:"",flag:!1,attachmentForm:{},uploadUrl:"http://211.71.233.52:80/attachment/upload",fileList:[],data:[],loading:!1,total:0}},mounted:function(){this.getPlan()},methods:{getPlan:function(){var e=this;F("/plan/plans").then((function(t){e.planList=t.rows,e.queryParams.planId=t.rows[0].planId,e.getAttachments()}))},getAttachments:function(){var e=this;F("/attachment/attachments/",this.queryParams).then((function(t){e.data=t.rows,e.total=t.total,e.loading=!1}))},handleAdd:function(){this.clearForm(),this.flag=!0,this.title="新增附件"},clearForm:function(){this.attachmentForm={path:"",fileName:"",planId:"",attachmentId:""},this.fileList=[]},submit:function(){var e=this;this.attachmentForm.attachmentId?T("/attachment/attachments",this.attachmentForm).then((function(t){e.flag=!1,e.getAttachments(),e.$message({type:"success",message:"修改成功"})})):(this.attachmentForm.planId=this.queryParams.planId,_("/attachment/attachments",this.attachmentForm).then((function(t){e.flag=!1,e.getAttachments(),e.$message({type:"success",message:"新增成功"})})))},uploadSuccess:function(e){e&&(this.attachmentForm.path=e.path,this.attachmentForm.fileName=e.fileName)},handleDelete:function(e){var t=this;this.$confirm('是否确认删除附件编号为"'+e.attachmentId+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return x("/attachment/attachments/"+e.attachmentId)})).then((function(){t.getAttachments(),t.$message({message:"删除成功",type:"success"})}))},handleChange:function(e,t){t.length>0&&(this.fileList=[t[t.length-1]])}}},Ze=Ye,Ge=Object(r["a"])(Ze,Je,We,!1,null,null,null),Ke=Ge.exports,Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[e._v(" 选择演练: ")]),a("el-col",{attrs:{span:1.5}},[a("el-select",{attrs:{size:"small"},on:{change:e.getReviewers},model:{value:e.queryParams.planId,callback:function(t){e.$set(e.queryParams,"planId",t)},expression:"queryParams.planId"}},e._l(e.planList,(function(e){return a("el-option",{key:e.planId,attrs:{label:e.planName,value:e.planId}})})),1)],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",disabled:!e.queryParams.planId},on:{click:e.handleAdd}},[e._v("新增评估人员")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[a("el-table-column",{attrs:{align:"center",prop:"userTel",label:"用户手机号"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getReviewers}}),a("el-dialog",{attrs:{title:e.title,visible:e.flag,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.flag=t}}},[a("el-form",{attrs:{model:e.reviewForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"人员名称"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.checkUserList,callback:function(t){e.checkUserList=t},expression:"checkUserList"}},e._l(e.userList,(function(e){return a("el-option",{key:e.userTel,attrs:{label:e.userName+"-"+e.userTel,value:e.userTel}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.flag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},Xe=[],et={data:function(){return{queryParams:{pageNum:1,pageSize:10,planId:""},planList:"",flag:!1,title:"",reviewForm:{},userList:[],data:[],loading:!1,checkUserList:[],total:0}},mounted:function(){this.getPlan(),this.getUsers()},methods:{getPlan:function(){var e=this;F("/plan/plans").then((function(t){e.planList=t.rows,e.queryParams.planId=t.rows[0].planId,e.getReviewers()}))},getUsers:function(){var e=this;F("/user/users").then((function(t){console.log(t),e.userList=t.rows}))},getReviewers:function(){var e=this;this.loading=!0,F("/reviewer/reviewers/",this.queryParams).then((function(t){e.data=t.rows,e.total=t.total,e.loading=!1}))},submit:function(){var e=this,t=this.checkUserList.join("-");this.reviewForm.userTel=t,_("/reviewer/reviewers",this.reviewForm).then((function(t){e.getReviewers(),e.flag=!1}))},handleAdd:function(){this.clearForm(),this.flag=!0,this.title="新增指标"},clearForm:function(){this.reviewForm={planId:this.queryParams.planId,userTel:""},this.checkUserList=[]},handleDelete:function(e){var t=this;this.$confirm('是否确认删除评估人员编号为"'+e.id+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return x("/reviewer/reviewers/"+e.id)})).then((function(){t.getReviewers(),t.$message({message:"删除成功",type:"success"})}))}}},tt=et,at=Object(r["a"])(tt,Qe,Xe,!1,null,null,null),nt=at.exports,st=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[e._v(" 选择预案: ")]),a("el-col",{attrs:{span:1.5}},[a("el-select",{attrs:{size:"small"},on:{change:e.getTargets},model:{value:e.queryParams.planId,callback:function(t){e.$set(e.queryParams,"planId",t)},expression:"queryParams.planId"}},e._l(e.planList,(function(e){return a("el-option",{key:e.planId,attrs:{label:e.planName,value:e.planId}})})),1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[a("el-table-column",{attrs:{align:"center",prop:"targetName",label:"指标名称"}}),a("el-table-column",{attrs:{align:"center",prop:"targetType",label:"指标类型"}}),a("el-table-column",{attrs:{label:"评估内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["打分"==t.row.targetType||"评语"==t.row.targetType?a("el-input",{model:{value:t.row.score,callback:function(a){e.$set(t.row,"score",a)},expression:"scope.row.score"}}):a("el-select",{model:{value:t.row.score,callback:function(a){e.$set(t.row,"score",a)},expression:"scope.row.score"}},e._l(t.row.options.split("_"),(function(e){return a("el-option",{key:e,attrs:{value:e}})})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("评估")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getTargets}})],1)},it=[],ot=a("b85c"),lt={data:function(){return{queryParams:{pageNum:1,pageSize:10,planId:""},total:0,planList:[],loading:!1,data:[],scoreForm:{},flag:!1,title:"评估"}},mounted:function(){this.getPlansByUserTel()},methods:{getPlansByUserTel:function(){var e=this;F("/reviewer/plans").then((function(t){e.planList=t,e.queryParams.planId=t[0].planId,e.getTargets()}))},getTargets:function(){var e=this;this.loading=!0,F("/target/targets",this.queryParams).then((function(t){e.data=t.rows,e.total=t.total,e.loading=!1,e.getScores()}))},getScores:function(){var e=this;F("/score/scores?planId="+this.queryParams.planId).then((function(t){var a,s=Object(ot["a"])(t.data);try{for(s.s();!(a=s.n()).done;){var i,o=a.value,l=Object(ot["a"])(e.data);try{for(l.s();!(i=l.n()).done;){var r=i.value;o.targetId===r.targetId&&(n["default"].set(r,"score",o.score),n["default"].set(r,"scoreId",o.scoreId))}}catch(c){l.e(c)}finally{l.f()}}}catch(c){s.e(c)}finally{s.f()}console.log(e.data)}))},handleUpdate:function(e){var t=this;e.scoreId?T("/score/scores",e).then((function(e){t.$message({type:"success",message:e.msg}),t.getTargets()})):_("/score/scores",e).then((function(e){t.$message({type:"success",message:e.msg}),t.getTargets()}))}}},rt=lt,ct=Object(r["a"])(rt,st,it,!1,null,null,null),ut=ct.exports,dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[e._v(" 选择演练: ")]),a("el-col",{attrs:{span:1.5}},[a("el-select",{attrs:{size:"small"},on:{change:e.getTargets},model:{value:e.queryParams.planId,callback:function(t){e.$set(e.queryParams,"planId",t)},expression:"queryParams.planId"}},e._l(e.planList,(function(e){return a("el-option",{key:e.planId,attrs:{label:e.planName,value:e.planId}})})),1)],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",disabled:!e.queryParams.planId},on:{click:e.handleAdd}},[e._v("新增指标")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[a("el-table-column",{attrs:{align:"center",prop:"targetName",label:"指标名称"}}),a("el-table-column",{attrs:{align:"center",prop:"enabled",label:"是否启用",formatter:e.enabledFormatter}}),a("el-table-column",{attrs:{align:"center",prop:"minScore",label:"最低分"}}),a("el-table-column",{attrs:{align:"center",prop:"maxScore",label:"最高分"}}),a("el-table-column",{attrs:{align:"center",prop:"description",label:"描述",width:"180"}}),a("el-table-column",{attrs:{align:"center",prop:"targetType",label:"指标类型"}}),a("el-table-column",{attrs:{align:"center",prop:"options",label:"选项"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getTargets}}),a("el-dialog",{attrs:{title:e.title,visible:e.flag,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.flag=t}}},[a("el-form",{attrs:{model:e.targetForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"指标名称"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.targetForm.targetName,callback:function(t){e.$set(e.targetForm,"targetName",t)},expression:"targetForm.targetName"}})],1),a("el-form-item",{attrs:{label:"是否启用"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.targetForm.enabled,callback:function(t){e.$set(e.targetForm,"enabled",t)},expression:"targetForm.enabled"}},e._l(e.enabledList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"演练描述"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.targetForm.description,callback:function(t){e.$set(e.targetForm,"description",t)},expression:"targetForm.description"}})],1),a("el-form-item",{attrs:{label:"指标类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.targetForm.targetType,callback:function(t){e.$set(e.targetForm,"targetType",t)},expression:"targetForm.targetType"}},e._l(e.targetTypeList,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value}})})),1),e.targetForm.targetType===e.targetTypeList[1].value?[a("el-button",{on:{click:e.addOption}},[e._v("新增")])]:e._e()],2),e.targetForm.targetType===e.targetTypeList[0].value?a("el-form-item",{attrs:{label:"最低分"}},[a("el-input",{attrs:{placeholder:"请输入最小分数"},model:{value:e.targetForm.minScore,callback:function(t){e.$set(e.targetForm,"minScore",t)},expression:"targetForm.minScore"}})],1):e._e(),e.targetForm.targetType===e.targetTypeList[0].value?a("el-form-item",{attrs:{label:"最高分"}},[a("el-input",{attrs:{placeholder:"请输入最大分数"},model:{value:e.targetForm.maxScore,callback:function(t){e.$set(e.targetForm,"maxScore",t)},expression:"targetForm.maxScore"}})],1):e._e(),e.targetForm.targetType===e.targetTypeList[1].value?e._l(e.dynamicOptionList,(function(t,n){return a("el-form-item",{key:t.key,attrs:{label:"选项"+n}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"option.value"}}),a("el-button",{on:{click:function(a){return a.preventDefault(),e.removeOption(t)}}},[e._v("删除")])],1)})):e._e()],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.flag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},pt=[],mt=(a("c975"),a("1276"),{data:function(){return{queryParams:{pageNum:1,pageSize:10,planId:""},data:[],planList:"",flag:!1,loading:!1,targetForm:{},targetTypeList:[{value:"打分"},{value:"单选"},{value:"评语"}],enabledList:[{label:"是",value:!0},{label:"否",value:!1}],title:"",dynamicOptionList:[{value:""}],total:0}},mounted:function(){this.getPlan()},methods:{getPlan:function(){var e=this;F("/plan/plans").then((function(t){e.planList=t.rows,e.queryParams.planId=t.rows[0].planId,e.getTargets()}))},getTargets:function(){var e=this;this.loading=!0,F("/target/targets/",this.queryParams).then((function(t){e.data=t.rows,e.total=t.total,e.loading=!1}))},handleAdd:function(){this.clearForm(),this.flag=!0,this.title="新增指标"},submit:function(){var e=this;if(this.targetForm.targetType==this.targetTypeList[1].value){var t=[];this.dynamicOptionList.forEach((function(e){t.push(e.value)})),this.targetForm.options=t.join("_"),this.targetForm.minScore="",this.targetForm.maxScore=""}this.targetForm.targetType==this.targetTypeList[2].value&&(this.targetForm.options="",this.targetForm.minScore="",this.targetForm.maxScore=""),this.targetForm.planId?T("/target/targets",this.targetForm).then((function(t){e.flag=!1,e.getTargets(),e.$message({message:"修改成功",type:"success"})})):(this.targetForm.planId=this.queryParams.planId,_("/target/targets",this.targetForm).then((function(t){e.flag=!1,e.getTargets(),e.$message({message:"新增成功",type:"success"})})))},clearForm:function(){this.targetForm={targetName:"",enabled:!0,minScore:"",maxScore:"",description:"",targetType:"",options:""},this.dynamicOptionList=[]},handleUpdate:function(e){var t=this;this.clearForm(),F("/target/targets/"+e.targetId).then((function(e){t.targetForm=e.data;var a=e.data.options.split("_");a.forEach((function(e){t.dynamicOptionList.push({key:Date.now(),value:e})})),t.flag=!0,t.title="修改指标"}))},handleDelete:function(e){var t=this;this.$confirm('是否确认删除指标编号为"'+e.targetId+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return x("/target/targets/"+e.targetId)})).then((function(){t.getTargets(),t.$message({message:"删除成功",type:"success"})}))},enabledFormatter:function(e,t,a){return a?"是":"否"},addOption:function(){this.dynamicOptionList.push({value:"",key:Date.now()})},removeOption:function(e){var t=this.dynamicOptionList.indexOf(e);-1!==t&&this.dynamicOptionList.splice(t,1)}}}),ht=mt,ft=Object(r["a"])(ht,dt,pt,!1,null,null,null),gt=ft.exports;n["default"].use(m["a"]);var vt=[{path:"/",name:"登录",hidden:!0,component:L},{path:"/home",name:"",hidden:!0,component:q},{path:"/home",component:q,iconCls:"fa fa-file-text-o",children:[{path:"/live",name:"直播管理",component:we}]},{path:"/home",name:"录播管理",component:q,iconCls:"fa fa-file-text-o",children:[{path:"/latestrecord",name:"最新录播",component:Ne},{path:"/record",name:"历史录播",component:$e}]},{path:"/home",name:"应急演练配置",component:q,iconCls:"fa fa-file-text-o",children:[{path:"/plan",name:"演练管理",component:He},{path:"/attachment",name:"附件管理",component:Ke}]},{path:"/home",component:q,children:[{path:"/user",name:"用户管理",iconCls:"fa fa-user-o",component:Ae}]},{path:"/home",name:"评估管理",component:q,children:[{path:"/target",name:"指标管理",component:gt},{path:"/reviewer",name:"评估人员管理",component:nt},{path:"/evaluation",name:"评估管理",iconCls:"fa fa-user-o",component:ut}]}],bt=new m["a"]({mode:"history",base:"/",routes:vt}),yt=bt,kt=a("2f62");n["default"].use(kt["a"]);var wt=new kt["a"].Store({state:{userTel:"",userName:""},mutations:{login:function(e,t){e.userTel=t.userTel,e.userName=t.userName},logout:function(e){e.userTel="",e.userName=""}},actions:{},modules:{}});n["default"].use(p.a);var _t=a("bd0c"),Tt=a.n(_t),xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},Ft=[],Pt=(a("a9e3"),{name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll}}}),$t=Pt,It=(a("2765"),Object(r["a"])($t,xt,Ft,!1,null,"590b682f",null)),St=It.exports;n["default"].component("Pagination",St),n["default"].use(Tt.a,{ak:"MaNFkHxfgMEfEodDwDsB6pbE95pj3dCB"}),n["default"].use(p.a),window.eventBus=new n["default"],n["default"].config.productionTip=!1,new n["default"]({router:yt,store:wt,render:function(e){return e(u)}}).$mount("#app")},"6a5a":function(e,t,a){},"7c6c":function(e,t,a){"use strict";a("ec07")},"857f":function(e,t,a){"use strict";a("aec9")},"85ec":function(e,t,a){},9917:function(e,t,a){"use strict";a("a8b4")},a8b4:function(e,t,a){},aec9:function(e,t,a){},c33f:function(e,t,a){},c8a0:function(e,t,a){},d4ac:function(e,t,a){"use strict";a("6a5a")},d7846:function(e,t,a){},d910:function(e,t,a){"use strict";a("dcac")},dcac:function(e,t,a){},eadb:function(e,t,a){"use strict";a("54ef")},eb6b:function(e,t,a){},ec07:function(e,t,a){}});
//# sourceMappingURL=app.0733b4e3.js.map